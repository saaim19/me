<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mohd Saaim Siddiqui | Interactive Portfolio</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=JetBrains+Mono:wght@400&display=swap');

        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            font-family: 'Rajdhani', sans-serif;
            color: white;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- UI LAYER --- */
        #ui-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* Header */
        #header {
            padding: 30px 40px;
            pointer-events: auto;
            text-shadow: 0 2px 5px rgba(0,0,0,0.8);
        }

        h1 {
            font-size: 2.5rem;
            margin: 0;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            background: linear-gradient(90deg, #fff, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            font-family: 'JetBrains Mono', monospace;
            color: #00ffff;
            font-size: 0.9rem;
            margin-top: 5px;
            opacity: 0.8;
        }

        /* Mobile Header Tweaks */
        @media (max-width: 768px) {
            #header { padding: 20px; }
            h1 { font-size: 1.8rem; }
            .subtitle { font-size: 0.75rem; }
        }

        /* Content Panel */
        #content-panel {
            position: absolute;
            background: rgba(10, 10, 15, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(0, 255, 255, 0.3);
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            padding: 40px;
            box-sizing: border-box;
            overflow-y: auto;
            box-shadow: 0 0 50px rgba(0,0,0,0.9);
            transition: transform 0.5s cubic-bezier(0.19, 1, 0.22, 1);
            z-index: 20;
        }

        /* Desktop: Slide from Right */
        @media (min-width: 769px) {
            #content-panel {
                top: 0; right: 0;
                width: 450px; height: 100vh;
                transform: translateX(100%);
                border-left: 1px solid rgba(0, 255, 255, 0.3);
            }
            #content-panel.active { transform: translateX(0); }
        }

        /* Mobile: Slide from Bottom */
        @media (max-width: 768px) {
            #content-panel {
                bottom: 0; left: 0;
                width: 100%; height: 75vh; 
                transform: translateY(105%); 
                border-top: 1px solid rgba(0, 255, 255, 0.3);
                border-radius: 20px 20px 0 0;
                padding: 25px;
            }
            #content-panel.active { transform: translateY(0); }
        }

        .panel-header {
            font-size: 1.8rem;
            color: #00ffff;
            border-bottom: 2px solid #00ffff;
            padding-bottom: 15px;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .section-block h3 { color: #ff00ff; font-size: 1.1rem; margin-bottom: 5px; margin-top: 20px; }
        .section-block h4 { font-family: 'JetBrains Mono', monospace; color: #fff; font-size: 0.85rem; margin: 0 0 10px 0; opacity: 0.7; }
        .section-block p, .section-block li { font-size: 1rem; line-height: 1.5; color: #d0d0d0; margin-bottom: 8px; }

        .close-btn {
            position: absolute;
            top: 20px; right: 20px;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid #00ffff;
            color: #00ffff;
            width: 30px; height: 30px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex; align-items: center; justify-content: center;
        }

        #loader {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #00ffff; font-family: 'JetBrains Mono', monospace; animation: blink 1s infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }

        #tap-hint {
            position: absolute; bottom: 30px; width: 100%; text-align: center;
            color: rgba(255,255,255,0.5); font-size: 0.8rem; pointer-events: none;
            text-transform: uppercase; animation: fadeUp 2s infinite;
            display: none;
        }
        @media (max-width: 768px) { #tap-hint { display: block; } }
        @keyframes fadeUp { 0% {opacity:0; transform:translateY(10px);} 50%{opacity:1;} 100%{opacity:0; transform:translateY(-10px);} }
    </style>
</head>
<body>

    <div id="loader">INITIALIZING SYSTEM...</div>

    <div id="ui-layer">
        <div id="header">
            <h1>Mohd Saaim Siddiqui</h1>
            <div class="subtitle">&lt;Backend Developer /&gt; Java &bull; Spring Boot</div>
        </div>
        <div id="tap-hint">Tap Nodes to Explore</div>
    </div>

    <div id="content-panel">
        <button class="close-btn" onclick="closePanel()">&times;</button>
        <div id="panel-body"></div>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';

        // --- DEVICE DETECTION & CONFIG ---
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth < 768;

        // --- RESUME DATA ---
        const resumeContent = {
            "summary": {
                title: "Summary Profile",
                html: `<div class="section-block"><p>Backend Developer with <strong>3+ years of experience</strong>.</p><p>Specialized in <strong>Java, Spring Boot, Microservices</strong>, and high-performance SQL/NoSQL databases.</p></div>`
            },
            "skills": {
                title: "Technical Stack",
                html: `<div class="section-block"><h3>Languages</h3><p>Java (Core & Advanced), Python</p><h3>Frameworks</h3><p>Spring Boot, Hibernate (JPA), Microservices</p><h3>Databases</h3><p>PostgreSQL, Aerospike, Elasticsearch, S3</p></div>`
            },
            "experience": {
                title: "Work Experience",
                html: `<div class="section-block"><h3>Tripjack - SDE 2</h3><h4>April 2024 - Present</h4><ul><li>Revamped Hotel Search API: <strong>< 1s response</strong>.</li><li>Built Transaction Report Module: <strong>98% accuracy</strong>.</li></ul><h3>Tripjack - SDE 1</h3><h4>July 2022 - March 2024</h4><ul><li>Optimized DB queries reducing time by <strong>20%</strong>.</li></ul></div>`
            },
            "projects": {
                title: "Projects & Education",
                html: `<div class="section-block"><h3>E-Commerce Platform</h3><p>Spring Boot app with <strong>85%+ test coverage</strong>.</p><h3>Education</h3><p><strong>MCA</strong> - Bharati Vidyapeeth (96.1%)</p></div>`
            }
        };

        // --- 1. SCENE SETUP ---
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x000000, 0.002);

        const camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 1, 1000);
        
        // --- ADAPTIVE CAMERA FUNCTION ---
        // This calculates the perfect distance based on screen aspect ratio
        function updateCameraBasePosition() {
            const aspect = window.innerWidth / window.innerHeight;
            // If aspect > 1 (Desktop), utilize height (130). 
            // If aspect < 1 (Mobile), utilize width (130 / aspect).
            // This ensures the 3D scene fits inside the viewport regardless of rotation.
            const distance = Math.max(130, 130 / aspect);
            return distance;
        }
        
        // Set initial Z
        let baseZ = updateCameraBasePosition();
        camera.position.z = baseZ;

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true, powerPreference: "high-performance" });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.body.appendChild(renderer.domElement);

        document.getElementById('loader').style.display = 'none';

        // --- 2. TEXT GENERATOR ---
        function createTextSprite(text, colorStr) {
            const canvas = document.createElement('canvas');
            canvas.width = 512;
            canvas.height = 128;
            const ctx = canvas.getContext('2d');
            ctx.font = 'bold 50px "Rajdhani"'; 
            ctx.fillStyle = colorStr;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.shadowColor = colorStr;
            ctx.shadowBlur = 20;
            ctx.fillText(text.toUpperCase(), 256, 64);

            const texture = new THREE.CanvasTexture(canvas);
            const material = new THREE.SpriteMaterial({ map: texture, transparent: true, depthTest: false, opacity: 0.9 });
            const sprite = new THREE.Sprite(material);
            
            const scale = isMobile ? 45 : 40;
            sprite.scale.set(scale, scale/4, 1);
            return sprite;
        }

        // --- 3. PARTICLES ---
        const pGeo = new THREE.BufferGeometry();
        const count = isMobile ? 1200 : 4000; 
        const pos = new Float32Array(count * 3);
        const vel = [];
        
        for(let i=0; i<count; i++) {
            pos[i*3] = (Math.random() - 0.5) * 800;
            pos[i*3+1] = (Math.random() - 0.5) * 800;
            pos[i*3+2] = (Math.random() - 0.5) * 800;
            vel.push({ x: (Math.random()-0.5)*0.1, y: (Math.random()-0.5)*0.1, z: (Math.random()-0.5)*0.1 });
        }
        pGeo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
        const pMat = new THREE.PointsMaterial({ size: isMobile ? 3 : 2, color: 0x44aaaa, transparent: true, opacity: 0.6 });
        const starField = new THREE.Points(pGeo, pMat);
        scene.add(starField);

        // --- 4. ARTIFACTS ---
        const objectsToCheck = []; 
        const animatables = []; 

        function createArtifact(id, label, colorHex, colorStr, type, position) {
            const group = new THREE.Group();
            group.position.copy(position);
            scene.add(group);

            let geo;
            const size = isMobile ? 12 : 9; 
            if(type === 'icosa') geo = new THREE.IcosahedronGeometry(size, 0);
            if(type === 'torus') geo = new THREE.TorusKnotGeometry(size/1.8, size/5, 64, 8);
            if(type === 'octa') geo = new THREE.OctahedronGeometry(size, 0);
            if(type === 'tetra') geo = new THREE.TetrahedronGeometry(size, 0);

            const mat = new THREE.MeshBasicMaterial({ color: colorHex, wireframe: true, transparent: true, opacity: 0.4 });
            const mesh = new THREE.Mesh(geo, mat);
            
            const coreMat = new THREE.MeshBasicMaterial({ color: colorHex, transparent: true, opacity: 0.1 });
            const core = new THREE.Mesh(geo, coreMat);
            core.scale.setScalar(0.9);
            mesh.add(core);
            group.add(mesh);

            const sprite = createTextSprite(label, colorStr);
            sprite.position.y = isMobile ? 20 : 14; 
            group.add(sprite);

            const lineMat = new THREE.LineBasicMaterial({ color: colorHex, transparent: true, opacity: 0.1 });
            const linePoints = [new THREE.Vector3(0,0,0), position];
            const lineGeo = new THREE.BufferGeometry().setFromPoints(linePoints);
            const line = new THREE.Line(lineGeo, lineMat);
            scene.add(line);

            mesh.userData = { id: id, parentGroup: group };
            objectsToCheck.push(mesh);
            animatables.push({ mesh: mesh, group: group, speed: Math.random() * 0.02 + 0.01 });
        }

        // --- UNIFIED LAYOUT STRATEGY ---
        // We use a tighter layout that works for both.
        // We moved Projects UP (from -40 to -30) to prevent it falling off screen.
        // We moved Side nodes IN (from 50 to 40) to make them safer on mobile.
        
        createArtifact('summary', 'Summary', 0x00ffff, '#00ffff', 'icosa', new THREE.Vector3(0, 20, 0));
        createArtifact('skills', 'Skills', 0xff00ff, '#ff00ff', 'torus', new THREE.Vector3(40, -5, 10));
        createArtifact('experience', 'Experience', 0xffff00, '#ffff00', 'octa', new THREE.Vector3(-40, -5, 10));
        createArtifact('projects', 'Projects', 0x00ff00, '#00ff00', 'tetra', new THREE.Vector3(0, -30, 20));

        // --- 5. INTERACTION & LOOP ---
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        const light = new THREE.PointLight(0xffffff, 2, 200);
        scene.add(light);

        let targetCamPos = new THREE.Vector3(0, 0, baseZ);
        let lookAtTarget = new THREE.Vector3(0, 0, 0);

        function handleInteraction(x, y, isClick) {
            mouse.x = (x / window.innerWidth) * 2 - 1;
            mouse.y = -(y / window.innerHeight) * 2 + 1;
            light.position.set(mouse.x * 80, mouse.y * 80, 50);

            if(isClick) {
                if(document.getElementById('content-panel').classList.contains('active')) return;

                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObjects(objectsToCheck);

                if (intersects.length > 0) {
                    const obj = intersects[0].object;
                    openPanel(obj.userData.id);
                    
                    // Zoom logic
                    const offset = obj.userData.parentGroup.position.clone().normalize().multiplyScalar(isMobile ? 60 : 35); 
                    targetCamPos = obj.userData.parentGroup.position.clone().add(offset);
                    lookAtTarget = obj.userData.parentGroup.position.clone();
                }
            }
        }

        window.addEventListener('mousemove', (e) => handleInteraction(e.clientX, e.clientY, false));
        window.addEventListener('click', (e) => handleInteraction(e.clientX, e.clientY, true));
        window.addEventListener('touchstart', (e) => handleInteraction(e.changedTouches[0].clientX, e.changedTouches[0].clientY, true), {passive: false});

        window.addEventListener('resize', () => {
            // Update Camera Aspect
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            
            // Update Base Z based on new aspect ratio
            baseZ = updateCameraBasePosition();
            
            // Only reset if panel is NOT open
            if(!document.getElementById('content-panel').classList.contains('active')) {
                targetCamPos.z = baseZ;
            }
        });

        const clock = new THREE.Clock();
        function animate() {
            requestAnimationFrame(animate);
            const time = clock.getElapsedTime();

            // Particles
            const pArr = starField.geometry.attributes.position.array;
            for(let i=0; i<count; i++) {
                pArr[i*3] += vel[i].x + (mouse.x * 0.5); 
                pArr[i*3+1] += vel[i].y + (mouse.y * 0.5);
                pArr[i*3+2] += vel[i].z;
                if(pArr[i*3] > 400) pArr[i*3] = -400; if(pArr[i*3] < -400) pArr[i*3] = 400;
                if(pArr[i*3+1] > 400) pArr[i*3+1] = -400; if(pArr[i*3+1] < -400) pArr[i*3+1] = 400;
            }
            starField.geometry.attributes.position.needsUpdate = true;

            // Objects
            animatables.forEach(item => {
                item.mesh.rotation.x += item.speed;
                item.mesh.rotation.y += item.speed;
                // Bobbing effect
                item.group.position.y += Math.sin(time * 2 + item.group.position.x) * 0.05;
            });

            // Smooth Camera
            camera.position.lerp(targetCamPos, 0.05);
            const currentLook = new THREE.Vector3();
            camera.getWorldDirection(currentLook);
            const targetLook = new THREE.Vector3().subVectors(lookAtTarget, camera.position).normalize();
            currentLook.lerp(targetLook, 0.05);
            camera.lookAt(camera.position.clone().add(currentLook));

            renderer.render(scene, camera);
        }
        animate();

        window.openPanel = function(id) {
            const data = resumeContent[id];
            document.getElementById('panel-body').innerHTML = `<div class="panel-header">${data.title}</div>${data.html}`;
            document.getElementById('content-panel').classList.add('active');
        };

        window.closePanel = function() {
            document.getElementById('content-panel').classList.remove('active');
            // Reset to calculated baseZ
            targetCamPos = new THREE.Vector3(0, 0, baseZ);
            lookAtTarget = new THREE.Vector3(0, 0, 0);
        };
    </script>
</body>
</html>
